#!/usr/bin/env python3
"""
# prepare for the following patient group comparisons:
# all samples: TP53wt vs. TP53mut
# all samples: FOXA1mut vs. FOXA1wt
# TP53wt samples: FOXA1mut vs. FOXA1wt
# TP53mut samples: FOXA1mut vs. FOXA1wt

# run for un-filtered data
remove_dupl_genes_endometrial reportName='remove_dupl_genes' >> ./data/output/set_up_endometrial/remove_dupl_genes__select_all.log
remove_dupl_genes_endometrial reportName='remove_dupl_genes' select_samples_title='select_all_sortFOXA1' select_samples_sort_by='FOXA1_mut5,TP53_mut5' >> ./data/output/set_up_endometrial/remove_dupl_genes__select_all_sortFOXA1.log
remove_dupl_genes_endometrial reportName='remove_dupl_genes' select_samples_from='TP53_mut5' select_samples_which=0 select_samples_title='select_TP53wt' select_samples_sort_by='FOXA1_mut5' >> ./data/output/set_up_endometrial/remove_dupl_genes__select_TP53wt.log
remove_dupl_genes_endometrial reportName='remove_dupl_genes' select_samples_from='TP53_mut5' select_samples_which=1 select_samples_title='select_TP53mut' select_samples_sort_by='FOXA1_mut5' >> ./data/output/set_up_endometrial/remove_dupl_genes__select_TP53mut.log

# run for filtered data
remove_dupl_genes_endometrial input_directory='output,set_up_endometrial_FILT' reportName='remove_dupl_genes' >> ./data/output/set_up_endometrial_FILT/remove_dupl_genes__select_all.log
remove_dupl_genes_endometrial input_directory='output,set_up_endometrial_FILT' reportName='remove_dupl_genes' select_samples_title='select_all_sortFOXA1' select_samples_sort_by='FOXA1_mut5,TP53_mut5' >> ./data/output/set_up_endometrial_FILT/remove_dupl_genes__select_all_sortFOXA1.log
remove_dupl_genes_endometrial input_directory='output,set_up_endometrial_FILT' reportName='remove_dupl_genes' select_samples_from='TP53_mut5' select_samples_which=0 select_samples_title='select_TP53wt' select_samples_sort_by='FOXA1_mut5' >> ./data/output/set_up_endometrial_FILT/remove_dupl_genes__select_TP53wt.log
remove_dupl_genes_endometrial input_directory='output,set_up_endometrial_FILT' reportName='remove_dupl_genes' select_samples_from='TP53_mut5' select_samples_which=1 select_samples_title='select_TP53mut' select_samples_sort_by='FOXA1_mut5' >> ./data/output/set_up_endometrial_FILT/remove_dupl_genes__select_TP53mut.log
"""
from omics_processing.io import (
    set_directory
    )
from gene_signatures.core import (
    custom_div_cmap
)
from gene_signatures.remove_duplicate_genes import (
    remove_duplicate_genes
)
import os
import sys
import plac
import logging
import matplotlib
import matplotlib.pyplot as plt

script_path = os.path.dirname(__file__)
script_fname = os.path.basename(__file__).rsplit('.')[0]


plot_kwargs = {
    'cmap_custom': custom_div_cmap(9),
    'vmin': -4,
    'vmax': 4,
    'highRes': True
}

set_up_kwargs_default = {
    # chose sample set from data
    # function: choose_samples()
    'select_samples_from': None,
    'select_samples_which': None,
    'select_samples_sort_by': 'TP53_mut5,FOXA1_mut5',
    'select_samples_title': 'select_all',

    # script set up params
    'saveReport': True,
    'compute_pdist': False,
    'txt_label': 'set up Oncoscan data',
    'input_fname': 'data_processed.csv',
    'toPrint': True,
    'reportName': script_fname,
    'gene_info_fname': 'genes_info.csv',
    'chr_col': 'chr_int',
    'gene_id_col': 'gene',
    'gene_order_dict_fname': None,
    'sample_info_fname': '20180704_emca.csv',
    'sample_info_table_index_colname': 'Oncoscan_ID',
    'plot_kwargs': plot_kwargs,

    # set directories
    'input_directory': 'output,set_up_endometrial',
    'sample_info_directory': 'input',
    'output_directory': None,
    'DEBUG': True
}


@plac.annotations(
    set_up_kwargs='keyword arguments'
)
def main(**set_up_kwargs):

    # update the default key/value pairs if the user gives different values
    # and take the union of all pairs
    set_up_kwargs_default.update(set_up_kwargs)

    if set_up_kwargs_default.get('DEBUG'):
        logging.basicConfig(stream=sys.stdout, level=logging.DEBUG)

    remove_duplicate_genes(**set_up_kwargs_default)


if __name__ == '__main__':
    plac.call(main)
